<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; ColonyOS  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_lesson.css?v=0c089442" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="_static/overrides.css?v=0572569b" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script src="_static/minipres.js?v=a0d29692"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Container Executors" href="executors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ColonyOS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">What is ColonyOS?</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#colonies-servers">Colonies servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#executors">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#functions">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#colony">Colony</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#security">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#meta-filesystem">Meta-filesystem</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Docker-compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html#production-server">Production server</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html#building-from-source">Building from source</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial - Developing an executor</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#connecting-to-a-colonies-server">Connecting to a Colonies server</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#registering-an-executor">Registering an executor</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#process-assignments">Process assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#complete-example">Complete example</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#logs">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#workflows">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial0.html#excercises">Excercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial - Executing containers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial1.html">What is a container?</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial1.html#execute-containers">Execute containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial1.html#managing-data">Managing data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial - GPUs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial2.html">Nvidia systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial2.html#amd-rocm-systems">AMD/ROCm systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial - Image processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial3.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial3.html#upload-dataset">Upload dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial3.html#docker-container">Docker container</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial3.html#training-the-model">Training the model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Colonies CLI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#colony">Colony</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#users">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#executors">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#functions">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#processes">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#logs">Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#attributes">Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#workflows">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#crons">Crons</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#generators">Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#filesystem">Filesystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="colonies-cli.html#security">Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions &amp; Workflows</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="funcwf.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Executors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="executors.html">Container Executors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Pollinator</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-new-project">Creating a new project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-code">Run the code</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ColonyOS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/colonyos/content/blob/main/content/pollinator.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p><strong>Pollinator</strong> is an application that simplifies the execution of jobs across different platforms. Pollinator is designed to simplify and
streamline job execution across platforms, e.g executing AI computations on HPC, Edge, or Kubernetes platforms.
<strong>Pollinator</strong> is also designed to ensure uniform and portable workload execution across these diverse platforms.</p>
<p><strong>Pollinator</strong> can significantly simplifies interactions with HPC or Kubernetes systems. For instance, it completely
eliminates the need to manually login to HPC nodes to run Slurm jobs. It seamlessly synchronizes and transfers data from the
user’s local filesystem to remote Executors, offering the convenience of a local development environment while
harnessing powerful supercomputers and cloud platforms. With <strong>Pollinator</strong>, users are no longer required to have
in-depth knowledge of Slurm or Kubernetes systems, speeding up development and making powerful HPC systems available to more people.</p>
<img alt="_images/pollinator_arch.png" src="_images/pollinator_arch.png" />
<section id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Link to this heading"></a></h2>
<p>Pollinator assumes the existance of the directories in the table below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Directory</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Synchronization Strategy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>./cfs/src</p></td>
<td><p>Contains source code or binaries
to be executed</p></td>
<td><p>Will be synchronized from local computer to remote
executor before execution</p></td>
</tr>
<tr class="row-odd"><td><p>./cfs/data</p></td>
<td><p>Datasets or other data is stored here</p></td>
<td><p>Will be synchronized from local computer before
execution, but not removed after job completion</p></td>
</tr>
<tr class="row-even"><td><p>./cfs/result</p></td>
<td><p>Produced data can be stored here.</p></td>
<td><p>Will be synchronized from remote executor to local
computer after execution</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>Synchronize the source, data, and result directories to the ColonyOS meta-filesystem.</p></li>
<li><p>Generate a ColonyOS function specification based on the <code class="docutils literal notranslate"><span class="pre">project.yaml</span></code> file.</p></li>
<li><p>Automatically generate and submit a ColonyOS function specification to a Colonies server.</p></li>
<li><p>If the job is assigned to an HPC Executor:</p>
<ol class="loweralpha simple">
<li><p>Pull the Docker container to the HPC environment, and convert it to a Singularity container.</p></li>
<li><p>Synchronize the source, data, and result directories to make the project file accessible on the remote HPC environment.</p></li>
<li><p>Generate a Slurm script to execute the Singularity container, including binding the source, data, and result directories to the container.</p></li>
<li><p>Execute and monitor the Slurm job, including uploading all standard outputs and error logs to a Colonies server.</p></li>
<li><p>Close the process by making a request to the Colonies server.</p></li>
</ol>
</li>
<li><p>If the job is assigned to a remote Kubernetes Executor:</p>
<ol class="loweralpha simple">
<li><p>Synchronize the source, data, and result directories to a shared Persistent Volume.</p></li>
<li><p>Generate and deploy a K8s batch job.</p></li>
<li><p>Monitor the execution of the batch job, including uploading logs to a Colonies server.</p></li>
<li><p>Close the process by making a request to the Colonies server.</p></li>
</ol>
</li>
</ol>
</section>
<section id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h2>
<p>To use <strong>Pollinator</strong>, you to have access to a colony where a <strong>KubeExecutor</strong> or an <strong>HPCExecutor</strong> is available. The following
environmental varialble must be set:</p>
<p>ColonyOS credentials (private keys and S3 keys) and configurations are available as
environmental variables. It also assumes the existance of an HPC Executor named <strong>lumi-standard-hpcexecutor</strong>, connected
to the LUMI standard CPU partition.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export COLONYOS_DASHBOARD_URL=&quot;...&quot;</span>
<span class="go">export COLONIES_TLS=&quot;true&quot;</span>
<span class="go">export COLONIES_SERVER_HOST=&quot;...&quot;</span>
<span class="go">export COLONIES_SERVER_PORT=&quot;443&quot;</span>
<span class="go">export COLONIES_COLONY_NAME=&quot;...&quot;</span>
<span class="go">export COLONIES_PRVKEY=&quot;...&quot;</span>
<span class="go">export AWS_S3_ENDPOINT=&quot;...&quot;</span>
<span class="go">export AWS_S3_ACCESSKEY=&quot;...&quot;</span>
<span class="go">export AWS_S3_SECRETKEY=&quot;...&quot;</span>
<span class="go">export AWS_S3_REGION_KEY=&quot;&quot;</span>
<span class="go">export AWS_S3_BUCKET=&quot;...&quot;</span>
<span class="go">export AWS_S3_TLS=&quot;true&quot;</span>
<span class="go">export AWS_S3_SKIPVERIFY=&quot;false&quot;</span>
</pre></div>
</div>
</section>
<section id="creating-a-new-project">
<h2>Creating a new project<a class="headerlink" href="#creating-a-new-project" title="Link to this heading"></a></h2>
<p>As an example, we are going to run some Python code at the <a class="reference external" href="https:///www.lumi-supercomputer.eu">LUMI</a> supercomputer in Finland.
When creating a new project, we must specify an <strong>executor type</strong>. Let’s list which executor is available in the colony:</p>
<p>Next, let’s generate a new <strong>Pollinator</strong> project with <a href="#id1"><span class="problematic" id="id2">**</span></a>lumi-std* as target executor.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir lumi</span>
<span class="go">cd lumi</span>
<span class="go">pollinator new -n lumi-std</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">INFO[0000] Creating directory                            Dir=./cfs/src</span>
<span class="go">INFO[0000] Creating directory                            Dir=./cfs/data</span>
<span class="go">INFO[0000] Creating directory                            Dir=./cfs/result</span>
<span class="go">INFO[0000] Generating                                    Filename=./project.yaml</span>
<span class="go">INFO[0000] Generating                                    Filename=./cfs/data/hello.txt</span>
<span class="go">INFO[0000] Generating                                    Filename=./cfs/src/main.py</span>
</pre></div>
</div>
<p>The generated <strong>project.yaml</strong> contains configuration need to run the <strong>./cfs/src/main.py</strong> Python source file.
Note that is possible to run <em>any</em> languge by using another Docker container.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">projectname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">11bdf92c7560bee1d8c154504427bfbb9483aabf130b60f17de5d88a5d5f4ece</span>
<span class="nt">conditions</span><span class="p">:</span>
<span class="w">  </span><span class="nt">executorNames</span><span class="p">:</span>
</pre></div>
</div>
<dl>
<dt>┆      - lumi-std</dt><dd><blockquote>
<div><p>odes: 1
processesPerNode: 1
cpu: 1000m
mem: 1000Mi
walltime: 600
gpu:</p>
<blockquote>
<div><p>count: 0
name: “”</p>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>environment:</dt><dd><p>docker: python:3.12-rc-bookworm
rebuildImage: false
cmd: python3
source: main.py</p>
</dd>
</dl>
</dd>
</dl>
<p>The code shows generated example code in <strong>main.py</strong>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="c1"># Print the hostname</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hostname:&quot;</span><span class="p">,</span> <span class="n">hostname</span><span class="p">)</span>

<span class="c1"># The projdir is the location on the executor where project dirs have been synced</span>
<span class="n">projdir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PROJECT_DIR&quot;</span><span class="p">))</span>

<span class="c1"># The processid is the unique id of the process where this code will execute at a remove executor</span>
<span class="n">processid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;COLONIES_PROCESS_ID&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;projdir:&quot;</span><span class="p">,</span> <span class="n">projdir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;processid:&quot;</span><span class="p">,</span> <span class="n">processid</span><span class="p">)</span>

<span class="c1"># Open the hello.txt file and print the content</span>
<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">projdir</span> <span class="o">+</span> <span class="s2">&quot;/data/hello.txt&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">contents</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>

<span class="c1"># Write the result to the a file in the result dir</span>
<span class="n">result_dir</span> <span class="o">=</span> <span class="n">projdir</span> <span class="o">+</span> <span class="s2">&quot;/result/&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">result_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">result_dir</span> <span class="o">+</span> <span class="s2">&quot;/result.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Hello, World!&quot;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="run-the-code">
<h2>Run the code<a class="headerlink" href="#run-the-code" title="Link to this heading"></a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pollinator run --follow</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Uploading main.py 100% [===============] (2.8 MB/s)</span>
<span class="go">Uploading hello.txt 100% [===============] (59 kB/s)</span>
<span class="go">INFO[0000] Process submitted                             ProcessID=138bdf7e51b669ff65c6c90188300ecf09a9536dd2669df5ba2da1eaa12c58e5</span>
<span class="go">INFO[0000] Follow process at https://dashboard.colonyos.io/process?processid=138bdf7e51b669ff65c6c90188300ecf09a9536dd2669df5ba2da1eaa12c58e5</span>
<span class="go">hostname: nid002237</span>
<span class="go">projdir: /cfs/49fb2248ff701f9a57a1a9eb845156bd5eb6ed286a854525bd119edbb4af21ad</span>
<span class="go">processid: 138bdf7e51b669ff65c6c90188300ecf09a9536dd2669df5ba2da1eaa12c58e5</span>
<span class="go">Hello world!</span>
<span class="go">INFO[0005] Process finished successfully                 ProcessID=138bdf7e51b669ff65c6c90188300ecf09a9536dd2669df5ba2da1eaa12c58e5</span>
<span class="go">Downloading result.txt 100% [===============] (419 B/s)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="executors.html" class="btn btn-neutral float-left" title="Container Executors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, RISE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>